<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Happy Birthday Anki</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="../../images/others/favicon.ico" type="image/x-icon" />
    <meta property="og:description" content="Wish you a very Happy Birthday">
      <link rel="stylesheet" type="text/css" href="../css/stylesheet.css">
      <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
  <link href="https://fonts.googleapis.com/css?family=Josefin+Sans:100,300&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      font-family: 'Josefin Sans', sans-serif;
      background: #000;
      overflow: hidden;
    }

    /* Collage Container */
    .background-collage {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      grid-auto-rows: 200px;
      gap: 3px;
      z-index: 0;
      padding: 0;
      background-color: #000;
    }

    .background-collage img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0.5;
      transition: opacity 1s ease, transform 1s ease, filter 1s ease;
      border-radius: 8px;
    }

    .background-collage img.glow {
      opacity: 2;
      transform: scale(1.4);
      filter: brightness(1.5) contrast(1.0) saturate(1.2);
      box-shadow: 0 0 30px 10px rgba(255, 255, 255, 0.6);
      z-index: 1;
    }

    /* Overlay and main content */
    .cover {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0; left: 0;
      background: rgba(0, 0, 0, 0.3);
      z-index: 2;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .overlay-static {
      text-align: center;
      color: white;
      z-index: 3;
    }

    .inline-blocks > .block {
      display: inline-block;
      vertical-align: middle;
    }

    .image {
      height: 140px;
      width: 140px;
      border-radius: 180px;
      border: 3px solid #fff;
      margin-top: 22px;
      margin-right: 40px;
    }

    .twenty-one {
      font-size: 240px;
      font-weight: 100;
      line-height: 180px;
      color: #fff;
    }

    .bday {
      font-size: 24px;
      color: #fff;
      font-weight: 300;
      text-align: center;
    }

    canvas {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: 1;
    }
  </style>
</head>
<body>

<!-- Collage Background -->
<div class="background-collage" id="collage-container"></div>

<!-- Audio -->
<audio id = "hbd" class="song" controls autoplay loop>
        <source src="../../audio/hbd1.mp3" type="audio/mpeg"></source>
     Your browser isn't invited for super fun audio time.
    </audio>

<!-- Canvas & Overlay -->
<canvas id="can"></canvas>
<div class="cover">
  <div class="overlay-static">
    <div class="inline-blocks">
      <h2 class="twenty-one block">2</h2>
      <img class="image block" src="../../images/humans/together/us1.jpg">
      <h2 class="twenty-one block">2</h2>
      <h2 class="twenty-one block">5</h2>
    </div>
    <h1 class="bday">Happy Birthday <a href="../../index.html" style="color: skyblue;">Anki</a></h1>
  </div>
</div>

<script>
  // Load 50 background images from current folder: 1.jpg to 50.jpg
  const collageContainer = document.getElementById("collage-container");
  for (let i = 1; i <= 50; i++) {
    const img = document.createElement("img");
    img.src = `./${i}.jpg`;
    collageContainer.appendChild(img);
  }

  // Randomly glow a few images every few seconds
  function glowRandomImages() {
    const images = document.querySelectorAll('.background-collage img');
    images.forEach(img => img.classList.remove('glow'));

    // Pick 5 random images to glow
    for (let i = 0; i < 5; i++) {
      const randomIndex = Math.floor(Math.random() * images.length);
      images[randomIndex].classList.add('glow');
    }
  }
  setInterval(glowRandomImages, 3000);
  glowRandomImages();

  // Fireflies animation
  const TwoPI = Math.PI * 2;
  var w = window.innerWidth;
  var h = window.innerHeight;
  var center_x = w / 2;
  var center_y = h / 2;

  var colors = ['#FF0000', '#E8D45B', '#8CFF00','#3F33FF','#FF3349','#33FFC7'];
  var max_distance = Math.abs(Math.max(center_x, center_y));
  var min_distance = Math.abs(Math.min(center_x, center_y));

  function Firefly(){
    var random_angle = Math.random() * TwoPI;
    this.x = center_x + Math.sin(random_angle) * ((Math.random() * (max_distance - min_distance) + min_distance));
    this.y = center_y + Math.cos(random_angle) * ((Math.random() * (max_distance - min_distance) + min_distance));
    this.angle_of_attack = Math.atan2(this.y - center_y , this.x - center_x);
    this.vel = (Math.random() * 50) + 20;
    this.color = colors[Math.floor(colors.length * Math.random())];
    this.xvel = this.vel * Math.cos(this.angle_of_attack);
    this.yvel = this.vel * Math.sin(this.angle_of_attack);
    this.size = 2 + Math.random() * 2;
    this.phase_diff = Math.random() * TwoPI;
  }

  Firefly.prototype.move = function(dt){
    if (isOnHeart(this.x, this.y)) {
      this.size -= 0.001;
      return;
    }
    this.x += this.xvel * dt;
    this.y += this.yvel * dt;
  };

  Firefly.prototype.render = function(ctx, now){
    if (this.size < 1) return;
    ctx.globalAlpha = Math.max(Math.abs(Math.sin((now + this.phase_diff) / (~~(this.size * 100)))), 0.4);
    ctx.fillStyle = this.color;
    ctx.shadowColor = this.color;
    ctx.shadowBlur = 20 / this.size;
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, TwoPI, false);
    ctx.closePath();
    ctx.fill();
  };
    window.addEventListener('DOMContentLoaded', () => {
    const audio = document.getElementById('hbd');

    // Try to play immediately (some browsers allow it)
    audio.play().catch(() => {
      // If autoplay fails, wait for user interaction
      document.addEventListener('click', () => {
        audio.play();
      }, { once: true });
    });
  });
  function isOnHeart(x,y){
    x = ((x - center_x) / (min_distance * 1.2)) * 1.8;
    y = ((y - center_y) / (min_distance)) * - 1.8;
    var x2 = x * x;
    var y2 = y * y;
    return (Math.pow((x2 + y2 - 1), 3) - (x2 * (y2 * y)) <= 0);
  }

  var canvas = document.getElementById('can');
  var ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  var fireflies = [];
  var max_fireflies = 500;
  var last = Date.now();
  var last_emit = 0;

  function render(){
    var audio = document.getElementById("hbd");
    audio.play();
    var now = Date.now();
    var dt = (last - now) / 1000;
    last = now;
    ctx.clearRect(0, 0, w, h);

    fireflies.forEach(f => {
      f.move(dt);
      f.render(ctx, now);
    });

    fireflies = fireflies.filter(f => f.size > 1);
    if (fireflies.length < max_fireflies && last_emit - now < -100) {
      fireflies.push(new Firefly());
      last_emit = now;
    }

    requestAnimationFrame(render);
  }

  render();
</script>

</body>
</html>
